import java.nio.file.Files
import java.nio.file.Paths
import java.io.File
import ch.so.agi.gretl.tasks.*

defaultTasks 'refreshSolr'
 
task publipub(type: Publisher){
  dataIdent = "ch.so.avt.kantonsstrassen"
  userFormats = true

  database = [dbUriPub,dbUserPub,dbPwdPub]
  dbSchema = "avt_kantonsstrassen_pub"
  modelsToPublish = "SO_AVT_Kantonsstrassen_Publikation_20200707"

  target = ["sftp://$sftpServerSogis/$sftpUserSogis", sftpUserSogis, sftpPwdSogis]
  kgdiService = [simiMetadataServiceUrl, simiMetadataServiceUser, simiMetadataServicePwd]
}

task refreshSolr(type:Exec, dependsOn:'publipub') {
        commandLine 'curl', '-i', '--max-time', '5', solrIndexupdaterBaseUrl + '/queue?ds=ch.so.avt.kantonsstrassen_achsen,ch.so.avt.kantonsstrassen_bezugspunkte'
}

/* 
task validate(type: ShpValidator){
    models = "SO_AVT_Achsen_Publikation_20200707"
    dataFiles = ["_shp/Bezugspunkte_ohneK2_point_point.shp","_shp/Achsen_line_line.shp"]
}
*/


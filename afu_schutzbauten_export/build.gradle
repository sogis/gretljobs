import ch.so.agi.gretl.tasks.*

apply plugin: 'ch.so.agi.gretl'

defaultTasks 'validateData'

def datasetname = dataset
def outFile = dataset + ".xtf"

/**
 * Exportiere das entsprechende Datast aus der Erfassungsdatenbank.
 */
task exportData(type: Ili2pgExport){
    description 'Exportiere ein Dataset aus der Erfassungs-DB'
    database = [dbUriEdit, dbUserEdit, dbPwdEdit]
    dbschema = "afu_schutzbauten_v1"
    dataset = datasetname
    dataFile = outFile
    models = "SO_AFU_Schutzbauten_20231212"
}

/**
 * Validiere den exportierten Datensatz
 */
task validateData(type: IliValidator){
    dependsOn exportData
    description 'Validiere den exportierten Datensatz'
    dataFiles = outFile
    logFile = "validation.log"
}
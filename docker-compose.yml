services:
  gretl:
    image: sogis/gretl:2.2.373
    profiles: ["app"]
    environment:
      ORG_GRADLE_PROJECT_gretlEnvironment: development
    entrypoint: ["gretl", "--project-cache-dir=/home/gradle/projectcache"]
    volumes:
      - $HOME/gretljobs.properties:/home/gradle/.gradle/gradle.properties
      - .:/home/gradle/project
      - ../schema-jobs:/home/gradle/schema-jobs
      - /tmp:/gretl-share
  edit-db:
    image: bitnami/postgresql:14.8.0-debian-11-r74
    environment:
      POSTGRESQL_DATABASE: edit
      POSTGRESQL_USERNAME: ddluser
      POSTGRESQL_PASSWORD: ddluser
      POSTGRESQL_POSTGRES_PASSWORD: secret
      POSTGRESQL_INITSCRIPTS_USERNAME: postgres
      POSTGRESQL_INITSCRIPTS_PASSWORD: secret
      #POSTGRESQL_INITDB_ARGS: --locale=de_CH.UTF-8
    ports:
      - "54321:5432"
    volumes:
      - ./setup.sql:/docker-entrypoint-preinitdb.d/setup.sql
      - ./prepare_setup.sh:/docker-entrypoint-preinitdb.d/prepare_setup.sh
      - postgresql_data_edit:/bitnami/postgresql
  pub-db:
    image: bitnami/postgresql:14.8.0-debian-11-r74
    environment:
      POSTGRESQL_DATABASE: pub
      POSTGRESQL_USERNAME: ddluser
      POSTGRESQL_PASSWORD: ddluser
      POSTGRESQL_POSTGRES_PASSWORD: secret
      POSTGRESQL_INITSCRIPTS_USERNAME: postgres
      POSTGRESQL_INITSCRIPTS_PASSWORD: secret
      #POSTGRESQL_INITDB_ARGS: --locale=de_CH.UTF-8
    ports:
      - "54322:5432"
    volumes:
      - ./setup.sql:/docker-entrypoint-preinitdb.d/setup.sql
      - ./prepare_setup.sh:/docker-entrypoint-preinitdb.d/prepare_setup.sh
      - postgresql_data_pub:/bitnami/postgresql
volumes:
  postgresql_data_edit:
  postgresql_data_pub:

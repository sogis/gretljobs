import ch.so.agi.gretl.tasks.*
import ch.so.agi.gretl.api.TransferSet

apply plugin: 'ch.so.agi.gretl'

defaultTasks 'calc_qg_verkehr_gem'

//Berechnung der Untergruppe bahn

task calc_ug_bahn_gesamt(type: Db2Db){

    sourceDb = [dbUriSogis, dbUserSogis, dbPwdSogis]
    targetDb = [dbUriSogis, dbUserSogis, dbPwdSogis]
    transferSets = [
            new TransferSet('ug_bahn/ug_bahn_gesamt.sql', 'ekat2015.ug_bahn_gesamt', true)
    ];
}

//Berechnung der Untergruppe Flug

task calc_ug_flug_gesamt(type: Db2Db){

    sourceDb = [dbUriSogis, dbUserSogis, dbPwdSogis]
    targetDb = [dbUriSogis, dbUserSogis, dbPwdSogis]
    transferSets = [
            new TransferSet('ug_flug/ug_flug_gesamt.sql', 'ekat2015.ug_flug_gesamt', true)
    ];
}

//Berechnung der Untergruppe Diff Verkehr

task calc_ug_diff_verkehr(type: Db2Db){

    sourceDb = [dbUriSogis, dbUserSogis, dbPwdSogis]
    targetDb = [dbUriSogis, dbUserSogis, dbPwdSogis]
    transferSets = [
            new TransferSet('ug_diff_verkehr/ug_diff_verkehr_eq_aufw_abr_lmw.sql', 'ekat2015.ug_diff_verkehr_eq_aufw_abr_lmw', true),
            new TransferSet('ug_diff_verkehr/ug_diff_verkehr_eq_aufw_abr_mr_2t.sql', 'ekat2015.ug_diff_verkehr_eq_aufw_abr_mr_2t', true),
            new TransferSet('ug_diff_verkehr/ug_diff_verkehr_eq_aufw_abr_mr_4t.sql', 'ekat2015.ug_diff_verkehr_eq_aufw_abr_mr_4t', true),
            new TransferSet('ug_diff_verkehr/ug_diff_verkehr_eq_aufw_abr_smw.sql', 'ekat2015.ug_diff_verkehr_eq_aufw_abr_smw', true),
            new TransferSet('ug_diff_verkehr/ug_diff_verkehr_eq_lnf.sql', 'ekat2015.ug_diff_verkehr_eq_lnf', true),
            new TransferSet('ug_diff_verkehr/ug_diff_verkehr_eq_pw.sql', 'ekat2015.ug_diff_verkehr_eq_pw', true)
    ];
}

//Berechnung der Tabellen ug_diff_verkehr_gesamt

task calc_ug_diff_verkehr_gesamt(type: Db2Db, dependsOn: [calc_ug_diff_verkehr]){

    sourceDb = [dbUriSogis, dbUserSogis, dbPwdSogis]
    targetDb = [dbUriSogis, dbUserSogis, dbPwdSogis]
    transferSets = [
            new TransferSet('ug_diff_verkehr/ug_diff_verkehr_gesamt.sql', 'ekat2015.ug_diff_verkehr_gesamt', true)
    ];
}

//Berechnung der Untergruppe Kaltstart

task calc_ug_kaltstart(type: Db2Db){

    sourceDb = [dbUriSogis, dbUserSogis, dbPwdSogis]
    targetDb = [dbUriSogis, dbUserSogis, dbPwdSogis]
    transferSets = [
            new TransferSet('ug_kaltstart/ug_kaltstart_eq_li.sql', 'ekat2015.ug_kaltstart_eq_li', true),
            new TransferSet('ug_kaltstart/ug_kaltstart_eq_pw.sql', 'ekat2015.ug_kaltstart_eq_pw', true)
    ];
}

//Berechnung der Tabellen ug_kaltstart_gesamt

task calc_ug_kaltstart_gesamt(type: Db2Db, dependsOn: [calc_ug_kaltstart]){

    sourceDb = [dbUriSogis, dbUserSogis, dbPwdSogis]
    targetDb = [dbUriSogis, dbUserSogis, dbPwdSogis]
    transferSets = [
            new TransferSet('ug_kaltstart/ug_kaltstart_gesamt.sql', 'ekat2015.ug_kaltstart_gesamt', true)
    ];
}

//Berechnung der Untergruppe Streckenverkehr (strkvk)

task calc_ug_strkvk(type: Db2Db){

    sourceDb = [dbUriSogis, dbUserSogis, dbPwdSogis]
    targetDb = [dbUriSogis, dbUserSogis, dbPwdSogis]
    transferSets = [
            new TransferSet('ug_strkvk/ug_strkvk_eq_aufw_abr_lmw.sql', 'ekat2015.ug_strkvk_eq_aufw_abr_lmw', true),
            new TransferSet('ug_strkvk/ug_strkvk_eq_aufw_abr_mr_2t.sql', 'ekat2015.ug_strkvk_eq_aufw_abr_mr_2t', true),
            new TransferSet('ug_strkvk/ug_strkvk_eq_aufw_abr_mr_4t.sql', 'ekat2015.ug_strkvk_eq_aufw_abr_mr_4t', true),
            new TransferSet('ug_strkvk/ug_strkvk_eq_aufw_abr_smw.sql', 'ekat2015.ug_strkvk_eq_aufw_abr_smw', true),
            new TransferSet('ug_strkvk/ug_strkvk_eq_li.sql', 'ekat2015.ug_strkvk_eq_li', true),
            new TransferSet('ug_strkvk/ug_strkvk_eq_mr.sql', 'ekat2015.ug_strkvk_eq_mr', true),
            new TransferSet('ug_strkvk/ug_strkvk_eq_pw.sql', 'ekat2015.ug_strkvk_eq_pw', true),
            new TransferSet('ug_strkvk/ug_strkvk_eq_rb.sql', 'ekat2015.ug_strkvk_eq_rb', true),
            new TransferSet('ug_strkvk/ug_strkvk_eq_running_losses_li.sql', 'ekat2015.ug_strkvk_eq_running_losses_li', true),
            new TransferSet('ug_strkvk/ug_strkvk_eq_running_losses_mr.sql', 'ekat2015.ug_strkvk_eq_running_losses_mr', true),
            new TransferSet('ug_strkvk/ug_strkvk_eq_running_losses_pw.sql', 'ekat2015.ug_strkvk_eq_running_losses_pw', true),
            new TransferSet('ug_strkvk/ug_strkvk_eq_snf.sql', 'ekat2015.ug_strkvk_eq_snf', true)
    ];
}

//Berechnung der Tabellen ug_strkvk_gesamt

task calc_ug_strkvk_gesamt(type: Db2Db, dependsOn: [calc_ug_strkvk]){

    sourceDb = [dbUriSogis, dbUserSogis, dbPwdSogis]
    targetDb = [dbUriSogis, dbUserSogis, dbPwdSogis]
    transferSets = [
            new TransferSet('ug_strkvk/ug_strkvk_gesamt.sql', 'ekat2015.ug_strkvk_gesamt', true),
            new TransferSet('ug_strkvk/ug_strkvk_links_gesamt.sql', 'ekat2015.ug_strkvk_links_gesamt', true)
    ];
}


//Berechnung der Untergruppe Verdampf

task calc_ug_verdampf(type: Db2Db){

    sourceDb = [dbUriSogis, dbUserSogis, dbPwdSogis]
    targetDb = [dbUriSogis, dbUserSogis, dbPwdSogis]
    transferSets = [
            new TransferSet('ug_verdampf/ug_verdampf_eq_motabst_li.sql', 'ekat2015.ug_verdampf_eq_motabst_li', true),
            new TransferSet('ug_verdampf/ug_verdampf_eq_motabst_pw.sql', 'ekat2015.ug_verdampf_eq_motabst_pw', true),
            new TransferSet('ug_verdampf/ug_verdampf_eq_tankatm_gem_li.sql', 'ekat2015.ug_verdampf_eq_tankatm_gem_li', true),
            new TransferSet('ug_verdampf/ug_verdampf_eq_tankatm_gem_mr.sql', 'ekat2015.ug_verdampf_eq_tankatm_gem_mr', true),
            new TransferSet('ug_verdampf/ug_verdampf_eq_tankatm_gem_pw.sql', 'ekat2015.ug_verdampf_eq_tankatm_gem_pw', true),
            new TransferSet('ug_verdampf/ug_verdampf_eq_tankatm_str_li.sql', 'ekat2015.ug_verdampf_eq_tankatm_str_li', true),
            new TransferSet('ug_verdampf/ug_verdampf_eq_tankatm_str_mr.sql', 'ekat2015.ug_verdampf_eq_tankatm_str_mr', true),
            new TransferSet('ug_verdampf/ug_verdampf_eq_tankatm_str_pw.sql', 'ekat2015.ug_verdampf_eq_tankatm_str_pw', true)
    ];
}

//Berechnung der Tabellen ug_verdampf_gesamt

task calc_ug_verdampf_gesamt(type: Db2Db, dependsOn: [calc_ug_verdampf]){

    sourceDb = [dbUriSogis, dbUserSogis, dbPwdSogis]
    targetDb = [dbUriSogis, dbUserSogis, dbPwdSogis]
    transferSets = [
            new TransferSet('ug_verdampf/ug_verdampf_gesamt.sql', 'ekat2015.ug_verdampf_gesamt', true)
    ];
}
//Berechnung der Quellengruppe Industrie und Gewerbe 

task calc_qg_verkehr(type: Db2Db, dependsOn: [calc_ug_bahn_gesamt, calc_ug_flug_gesamt, calc_ug_diff_verkehr_gesamt, calc_ug_kaltstart_gesamt, calc_ug_strkvk_gesamt, calc_ug_verdampf_gesamt]){

    sourceDb = [dbUriSogis, dbUserSogis, dbPwdSogis]
    targetDb = [dbUriSogis, dbUserSogis, dbPwdSogis]
    transferSets = [
            new TransferSet('qg_verkehr.sql', 'ekat2015.qg_verkehr', true),
            new TransferSet('ug_bahn/ug_bahn_gesamt_gem.sql', 'ekat2015.ug_bahn_gesamt_gem', true),
            new TransferSet('ug_flug/ug_flug_gesamt_gem.sql', 'ekat2015.ug_flug_gesamt_gem', true),
            new TransferSet('ug_diff_verkehr/ug_diff_verkehr_gesamt_gem.sql', 'ekat2015.ug_diff_verkehr_gesamt_gem', true), 
            new TransferSet('ug_kaltstart/ug_kaltstart_gesamt_gem.sql', 'ekat2015.ug_kaltstart_gesamt_gem', true),
            new TransferSet('ug_strkvk/ug_strkvk_gesamt_gem.sql', 'ekat2015.ug_strkvk_gesamt_gem', true),
            new TransferSet('ug_verdampf/ug_verdampf_gesamt_gem.sql', 'ekat2015.ug_verdampf_gesamt_gem', true)
    ];
}

task calc_qg_verkehr_gem(type: Db2Db, dependsOn: [calc_qg_verkehr]){

    sourceDb = [dbUriSogis, dbUserSogis, dbPwdSogis]
    targetDb = [dbUriSogis, dbUserSogis, dbPwdSogis]
    transferSets = [
            new TransferSet('qg_verkehr_gemeinde.sql', 'ekat2015.qg_verkehr_gemeinde', true)
    ];
}


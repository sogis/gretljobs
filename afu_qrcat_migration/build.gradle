import ch.so.agi.gretl.tasks.*
import ch.so.agi.gretl.api.TransferSet

apply plugin: 'ch.so.agi.gretl'

defaultTasks 'transfer_qrcat'

def DB_Schema_QRcat = "afu_qrcat_v1"

task "clean_qrcat_before_import"(type: SqlExecutor) {
    description = "QRcat Daten in der richtigen Reihenfolge (dependencies) l√∂schen vor dem Neuimport"
    database = [dbUriEdit, dbUserEdit, dbPwdEdit]
    sqlParameters = [DB_Schema_QRcat:DB_Schema_QRcat]
    sqlFiles = ['delete_qrcat.sql']
}

task transfer_qrcat(type: Db2Db,dependsOn: "clean_qrcat_before_import"){
    description = "Migration QRcat-Daten aus alter 'sogis' PostgreSQL-Datenbank"
    sourceDb = [dbUriSogis, dbUserSogis, dbPwdSogis]
    targetDb = [dbUriEdit, dbUserEdit, dbPwdEdit]
    transferSets = [
            new TransferSet('qrcat_detailszenario_grundhaeufigkeit.sql', 'afu_qrcat_v1.qrcat_detailszenario_grundhaeufigkeit', false),
            new TransferSet('qrcat_toxreferenzszenario.sql', 'afu_qrcat_v1.qrcat_toxreferenzszenario', false),
            new TransferSet('qrcat_fwert.sql', 'afu_qrcat_v1.qrcat_fwert', false)//,
            //new TransferSet('qrcat_szenario.sql', 'afu_qrcat_v1.qrcat_szenario', true)
    ];
}
